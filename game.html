<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Heartwired â€” Game Start</title>
  <meta name="viewport" content="width=800">
  <link rel="stylesheet" href="style.css">
  <style>
    @font-face {
      font-family: 'PixelFont';
      src: url('https://fonts.cdnfonts.com/s/17154/PressStart2P-Regular.ttf') format('truetype');
      font-display: swap;
    }
    body {
      background: #000;
      margin: 0;
      overflow: hidden;
      height: 100vh;
      width: 100vw;
      font-family: 'PixelFont', monospace;
      user-select: none;
    }
    #monitor-wrapper {
      display: flex; justify-content: center; align-items: center;
      width: 100vw; height: 100vh;
      position: absolute; top:0; left:0;
      z-index: 2;
      opacity: 1;
      transition: opacity 1.5s;
    }
    .monitor {
      width: 400px; height: 300px;
      background: #333;
      border-radius: 16px 16px 40px 40px;
      border: 10px solid #111;
      position: relative;
      box-shadow: 0 0 60px #222;
      display: flex; align-items: center; justify-content: center;
      transition: transform 3s, opacity 1.5s;
    }
    .screen {
      width: 350px; height: 220px;
      background: #fff;
      border-radius: 8px;
      box-shadow: 0 0 24px #fff8, 0 0 40px #fff4;
      opacity: 1;
      transition: background 0.15s, opacity 0.3s;
    }
    #typewriter-container {
      position: absolute; left: 50%; top: 60%;
      transform: translate(-50%, -50%);
      padding: 32px;
      color: #fff;
      font-size: 1.2em;
      background: rgba(0,0,0,0.8);
      border-radius: 8px;
      min-width: 600px;
      min-height: 120px;
      letter-spacing: 1.5px;
      z-index: 6;
      opacity: 0;
      transition: opacity 1.4s;
      font-family: 'PixelFont', monospace;
      border: 2px solid #fff;
      white-space: pre-line;
      text-shadow: 2px 2px #1b0103;
    }
    #fader {
      position:fixed; top:0;left:0;width:100vw;height:100vh;
      pointer-events: none;
      opacity: 0;
      transition: opacity 2.2s;
      z-index: 9;
    }
    #game-scene {
      position: absolute; top:0;left:0; width:100vw; height:100vh;
      z-index: 10;
      display: flex; justify-content:center; align-items:center;
      background: #000;
      opacity: 0;
      transition: opacity 2s;
    }
    .sprite {
      image-rendering: pixelated;
      image-rendering: crisp-edges;
      width: 96px;
      height: 96px;
      position: absolute;
      left: 50%; top: 70%;
      transform: translate(-50%, -50%);
      opacity: 0;
      transition: opacity 1.1s, filter 0.2s;
      z-index: 21;
    }
  </style>
</head>
<body>
  <div id="monitor-wrapper">
    <div class="monitor" id="monitor">
      <div class="screen" id="screen"></div>
    </div>
  </div>
  <div id="typewriter-container"></div>
  <div id="game-scene">
    <img id="player-floor" class="sprite"
      src="https://piskel-imgstore-b.appspot.com/img/6d8b9acc-6154-11f0-822d-8745c3739ca1.gif" 
      alt="player on floor" />
    <img id="player-up" class="sprite"
      src="https://piskel-imgstore-b.appspot.com/img/96330770-6155-11f0-a252-8745c3739ca1.gif"
      alt="player stands up" style="display:none"/>
  </div>
  <div id="fader"></div>
  <script>
    // DOM references
    const monitorWrapper = document.getElementById('monitor-wrapper');
    const monitor = document.getElementById('monitor');
    const screen = document.getElementById('screen');
    const typewriterContainer = document.getElementById('typewriter-container');
    const gameScene = document.getElementById('game-scene');
    const fader = document.getElementById('fader');
    // Sprites
    const playerFloor = document.getElementById('player-floor');
    const playerUp = document.getElementById('player-up');

    // --- Animation sequence ---
    async function startSequence() {
      // Flicker monitor screen, then zoom in as before
      await sleep(400);
      monitorWrapper.style.opacity = 1;
      monitor.style.transform = "scale(1)";
      screen.style.background = "#fff";
      await sleep(700);

      // Flicker
      screen.style.opacity = "0.4";
      await sleep(90);
      screen.style.opacity = "1";
      await sleep(120);
      screen.style.opacity = "0.15";
      await sleep(110);
      screen.style.opacity = "1";
      await sleep(150);
      screen.style.opacity = "0.27";
      await sleep(160);
      screen.style.opacity = "1";
      await sleep(400);
      // Zoom in
      monitor.style.transform = "scale(1.2)";
      await sleep(1700);

      // Red screen then turn off
      screen.style.background = "#fb2221";
      await sleep(450);
      screen.style.opacity = "0";
      await sleep(550);

      // Hide monitor/transition out
      monitorWrapper.style.opacity = 0;
      await sleep(1700);

      // Begin typewriter story
      typewriterContainer.style.opacity = 1;
      await sleep(800);

      // --- Typewriter effect ---
      await typeWriterText([
        "Once upon a time, a young girl named Kaylee was just listening to some music in her room, and doing nothing but enjoying life.",
        "",
        "When out of nowhere she blinked and was gone from her room, instead just a pitch black room. No lights, no vision, or anything from her room!",
        "",
        "Where could she have gone, what could have happened...?"
      ]);

      await sleep(700);
      // Fade entire screen to white ("she's discovered on the ground")
      fader.style.background = "#fff";
      fader.style.opacity = 1;
      await sleep(2500);

      typewriterContainer.style.opacity = 0;

      // Black room scene, player found on floor
      fader.style.transition = "opacity 2.2s";
      fader.style.opacity = 0;
      await sleep(2200);

      gameScene.style.opacity = 1;
      playerFloor.style.opacity = 1;

      // Player shakes on floor
      await playerShake("player-floor", 9, 35, 28);
      await sleep(100);
      // Snap up to stand
      playerFloor.style.display = 'none'; playerUp.style.display = '';
      playerUp.style.opacity = "1";

      // Animate shake in standing pose as a quick effect
      await playerShake("player-up", 6, 16, 25);
      // Next: continue with next sequence/gameplay
    }

    function sleep(ms) {
      return new Promise(r => setTimeout(r, ms));
    }
    // --- Typewriter ---
    async function typeWriterText(lines) {
      for (let i = 0; i < lines.length; ++i) {
        await typeWriterLine(lines[i]);
        if (i !== lines.length-1) await sleep(1000);
      }
    }
    async function typeWriterLine(line) {
      typewriterContainer.innerHTML = "";
      for (let i = 0; i < line.length; ++i) {
        typewriterContainer.innerHTML += line[i];
        await sleep(26 + Math.random() * 18);
      }
      typewriterContainer.innerHTML += "<br/>";
    }

    // --- Player shake animation ---
    async function playerShake(id, times, maxDist=24, speed=24) {
      const el = document.getElementById(id);
      const orig = el.style.transform || "translate(-50%, -50%)";
      for (let i = 0; i < times; ++i) {
        el.style.transform = `translate(-50%, -50%) translateX(${-maxDist}px)`;
        await sleep(speed);
        el.style.transform = `translate(-50%, -50%) translateX(${maxDist}px)`;
        await sleep(speed);
      }
      el.style.transform = orig;
    }

    // Start
    window.onload = startSequence;
  </script>
</body>
</html>
